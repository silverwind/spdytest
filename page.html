<html>
<head>
    <title>spdytest</title>
</head>
<body>
    <input type="file" name="file" id="file" multiple="multiple"><button name="go" id="go">go</button>
    <script type="text/javascript">
        window.addEventListener("load", function load() {
            document.getElementById("go").addEventListener("click", function() {
                var files = document.getElementById("file").files,
                    start, total, formData = new FormData();

                for (var i = 0, len = files.length; i < len; i++)
                    formData.append(files[i].name, files[i]);

                var xhr = new XMLHttpRequest();
                xhr.upload.addEventListener("progress", function(event) {
                    if (total === undefined) total = event.total;
                }, false);

                xhr.upload.addEventListener("load", function(event) {
                    var speed = Math.round(total / ((new Date().getTime() - start)/1000)),
                        line = document.createElement("p");

                    line.innerHTML = "<p>xhr2 done - " + speed + " bytes/sec</p>";
                    document.getElementsByTagName("body")[0].appendChild(line);
                }, false);

                start = new Date().getTime();
                xhr.open("post", "/upload", true);
                xhr.send(formData);
            }, false);
        }, false);
    </script>
</body>
</html>